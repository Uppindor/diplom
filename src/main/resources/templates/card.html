<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü—Ä–æ—Ñ–∏–ª—å</title>
    <script src="https://cdn.jsdelivr.net/npm/lucide@latest"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" />
    <link rel="stylesheet" th:href="@{/css/main_my_project.css}" />
    <style>
        .sidebar input, .sidebar textarea {
            width: 100%;
            margin-bottom: 10px;
            padding: 5px;
        }

        button {
            margin-top: 10px;
            padding: 8px 12px;
            cursor: pointer;
        }

        .heart {
            position: absolute;
            bottom: 20px;
            right: 20px;
        }

        .heart-badge {
            background-color: red;
            color: white;
            padding: 5px;
            border-radius: 50%;
            position: absolute;
            top: 0;
            left: 0;
        }

        .container {
            margin-top: 20px;
        }

        /* –ù–æ–≤—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è –∫–∞—Ä—Ç–æ—á–µ–∫, —á—Ç–æ–±—ã –æ–Ω–∏ —Ä–∞—Å–ø–æ–ª–∞–≥–∞–ª–∏—Å—å –æ–¥–Ω–∞ –∑–∞ –¥—Ä—É–≥–æ–π */
        .card {
            margin-bottom: 20px; /* –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É –∫–∞—Ä—Ç–æ—á–∫–∞–º–∏ */
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background-color: #fff;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .card-stack {
            position: relative;
            width: 100%;
            max-width: 400px;
            height: 500px;
    margin: 40px auto 0; /* –≤–µ—Ä—Ö: 40px, –∞–≤—Ç–æ –ø–æ –±–æ–∫–∞–º, –Ω–∏–∑: 0 */

        }

        .card-stack .card {
            position: absolute;
            width: 100%;
            height: 100%;
            background: #fff;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
            padding: 20px;
            box-sizing: border-box;
            transition: transform 0.5s ease, opacity 0.5s ease;
        }
        .icon-btn {
            display: inline-flex;
            align-items: center;
            padding: 8px 12px;
            background-color: #f0f0f0;
            border: none;
            border-radius: 6px;
            text-decoration: none;
            color: inherit;
            cursor: pointer;
            gap: 6px;
            transition: background-color 0.2s;
        }
        .icon-btn:hover {
            background-color: #e0e0e0;
        }
    </style>
</head>
<body>

<!-- Header with buttons -->
<div class="header">
    <div class="header-left"></div>
    <div class="header-center">
        <a href="/profile" class="icon-btn" aria-label="–ü—Ä–æ—Ñ–∏–ª—å" role="button">
            <span>–ü—Ä–æ—Ñ–∏–ª—å</span>
            <i data-lucide="user"></i>
        </a>
        <a th:href="@{'/chat/' + ${currentUsername}}" class="icon-btn" aria-label="–°–æ–æ–±—â–µ–Ω–∏—è" role="button">
            <span>–°–æ–æ–±—â–µ–Ω–∏—è</span>
            <i data-lucide="message-circle"></i>
        </a>
        <a href="/likes" class="icon-btn" role="button">
            <span>–ó–Ω–∞–∫–æ–º—Å—Ç–≤–∞</span>
        </a>
        <a href="/setting" class="icon-btn" aria-label="–ù–∞—Å—Ç—Ä–æ–π–∫–∏" role="button">
            <span>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</span>
            <i data-lucide="settings"></i>
        </a>
    </div>
    <div class="header-right"></div>
</div>

<!-- Profile Card -->
<div class="card-stack" id="cardStack">
    <div class="card" th:each="user, iterStat : ${users}"
         th:data-user-id="${user.id}"
         th:style="'z-index:' + (${users.size()} - ${iterStat.index})">
        <img th:if="${user.images.?[main].size() > 0}"
             th:src="@{'/image/' + ${user.images.?[main].get(0).id}}"
             alt="–§–æ—Ç–æ –ø—Ä–æ—Ñ–∏–ª—è" width="100%">
        <h2 th:text="${user.username}">–ò–º—è</h2>
        <p th:text="'–í–æ–∑—Ä–∞—Å—Ç: ' + ${user.age}"></p>

        <!-- –°–∫—Ä—ã—Ç—ã–µ —Ñ–æ—Ä–º—ã –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –ª–∞–π–∫–∞/–¥–∏–∑–ª–∞–π–∫–∞ -->
        <form th:action="@{/card/like/{id}(id=${user.id})}" method="post" class="like-form"></form>
        <form th:action="@{/card/pass/{id}(id=${user.id})}" method="post" class="pass-form"></form>
        <div class="controls text-center mt-4">
            <button onclick="handleSwipe('left')" class="btn btn-danger mx-2">üëé –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å</button>
            <button onclick="handleSwipe('right')" class="btn btn-success mx-2">üëç –õ–∞–π–∫</button>
        </div>
        <button onclick="toggleSidebar()">–û —Å–µ–±–µ</button>
    </div>
</div>

<div th:if="${#lists.isEmpty(users)}">
    <h3>–ù–æ–≤—ã—Ö –∞–Ω–∫–µ—Ç –ø–æ–∫–∞ –Ω–µ—Ç üò¢</h3>
</div>


    <!-- Sidebar remains the same -->
    <div class="sidebar" id="sidebar" th:each="user, iterStat : ${users}"
         th:data-user-id="${user.id}"
         th:style="'z-index:' + (${users.size()} - ${iterStat.index})">
        <h3>–û —Å–µ–±–µ</h3>
        <textarea id="about" text="about">–ö—Ä–∞—Ç–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–µ–±–µ.</textarea>

        <h3>–†–∞–±–æ—Ç–∞</h3>
        <input type="text" id="work" th:value="${user.work}" placeholder="–ú–µ—Å—Ç–æ —Ä–∞–±–æ—Ç—ã, –¥–æ–ª–∂–Ω–æ—Å—Ç—å.">

        <h3>–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ</h3>
        <input type="text" id="education" th:value="${user.education}" placeholder="–£–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç, —Ñ–∞–∫—É–ª—å—Ç–µ—Ç, –≥–æ–¥ –≤—ã–ø—É—Å–∫–∞.">

        <h3>–°–≤–æ–±–æ–¥–Ω–æ–µ –≤—Ä–µ–º—è</h3>
        <input type="text" id="hobbies" th:value="${user.hobbies}" placeholder="–ß–µ–º —É–≤–ª–µ–∫–∞–µ—Ç–µ—Å—å –≤ —Å–≤–æ–±–æ–¥–Ω–æ–µ –≤—Ä–µ–º—è.">

        <h3>–õ–∏—á–Ω–æ–µ</h3>
        <input type="text" id="personal" th:value="${user.personal}" placeholder="–ö–∞–∫–∏–µ-—Ç–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–µ –ª–∏—á–Ω—ã–µ —Ñ–∞–∫—Ç—ã.">

        <h3>–ú—É–∑—ã–∫–∞</h3>
        <input type="text" id="music" th:value="${user.music}" placeholder="–õ—é–±–∏–º—ã–µ –º—É–∑—ã–∫–∞–ª—å–Ω—ã–µ –∂–∞–Ω—Ä—ã –∏ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–∏.">

        <button onclick="saveChanges()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è</button>
    </div>
</div>

<script>
    // Toggle sidebar for profile editing
    function toggleSidebar() {
        const sidebar = document.getElementById("sidebar");
        sidebar.classList.toggle("open");
    }

    // Save the changes and close the sidebar
    function saveChanges() {
        let aboutText = document.getElementById("about").value;
        let educationText = document.getElementById("education").value;
        let workText = document.getElementById("work").value;
        let hobbiesText = document.getElementById("hobbies").value;
        let personalText = document.getElementById("personal").value;
        let musicText = document.getElementById("music").value;

        alert("–î–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω—ã:\n\n" +
            "–û —Å–µ–±–µ: " + aboutText + "\n" +
            "–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ: " + educationText + "\n" +
            "–†–∞–±–æ—Ç–∞: " + workText + "\n" +
            "–°–≤–æ–±–æ–¥–Ω–æ–µ –≤—Ä–µ–º—è: " + hobbiesText + "\n" +
            "–õ–∏—á–Ω–æ–µ: " + personalText + "\n" +
            "–ú—É–∑—ã–∫–∞: " + musicText
        );

        toggleSidebar(); // Close sidebar
    }
</script>
<script>
    const cards = document.querySelectorAll('.card-stack .card');
 let current = cards.length - 1;  // –ù–∞—á–∏–Ω–∞–µ–º —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π –∫–∞—Ä—Ç–æ—á–∫–∏

 function handleSwipe(direction) {
     if (current < 0) return;

     const card = cards[current];
     const angle = direction === 'left' ? -30 : 30;
     const x = direction === 'left' ? -1000 : 1000;

     // –ê–Ω–∏–º–∞—Ü–∏—è
     card.style.transform = `translateX(${x}px) rotate(${angle}deg)`;  // –ü–µ—Ä–µ–º–µ—â–∞–µ–º –∫–∞—Ä—Ç–æ—á–∫—É
     card.style.opacity = 0;  // –°–∫—Ä—ã–≤–∞–µ–º –∫–∞—Ä—Ç–æ—á–∫—É

     // –û—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–æ—Ä–º—ã –ø–æ—Å–ª–µ –∞–Ω–∏–º–∞—Ü–∏–∏
     setTimeout(() => {
         const form = card.querySelector(direction === 'left' ? '.pass-form' : '.like-form');
         form.submit();
     }, 400);

     // –ü–µ—Ä–µ–º–µ—â–∞–µ–º—Å—è –∫ —Å–ª–µ–¥—É—é—â–µ–π –∫–∞—Ä—Ç–æ—á–∫–µ
     current--;
 }

</script>


<script>
    lucide.createIcons();  // Initialize icons
</script>

</body>
</html>
